# CoSpec AI Development Docker Compose
# Usage: docker compose -f docker-compose-dev.yml up
# Mounts source directories for live reloading during development

services:
  cospec-ai-app-dev:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: cospec-ai-app-dev
    ports:
      - "3000:3000" # 前端端口
      - "3001:3001" # 後端 API 端口
    volumes:
      - ./app-react:/app-react # 掛載前端源碼目錄，方便開發
      - /app-react/node_modules # 匿名卷，防止本地目錄覆蓋容器內的 node_modules
      - ./server:/server # 掛載後端源碼目錄，方便開發
      - /server/node_modules # 匿名卷，防止本地目錄覆蓋容器內的 node_modules
      - ${MARKDOWN_DIR:-./markdown}:/markdown # 掛載 Markdown 文件目錄
    environment:
      - MARKDOWN_DIR=/markdown
      - NODE_ENV=development
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - OPENAI_BASE_URL=${OPENAI_BASE_URL:-https://api.openai.com/v1}
      - OPENAI_MODEL=${OPENAI_MODEL:-gpt-3.5-turbo}
    restart: unless-stopped
